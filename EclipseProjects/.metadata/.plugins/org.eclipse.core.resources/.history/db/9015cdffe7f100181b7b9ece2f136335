package com.view;

import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;
import java.util.ArrayList;

import javax.swing.JPanel;

import com.model.Bullet;
import com.model.Enemy;
import com.model.Player;
import com.thread.DrawableThread;


public class MyPanel extends JPanel {
	
	public DrawableThread thread;
	public Player player;
	public ArrayList<Bullet> bullets = new ArrayList<Bullet>();
	public ArrayList<Enemy> enemies = new ArrayList<Enemy>();
	
	public Image bg;
	public int top = 0;
	public int timer = 0;
	
	public MyPanel() {
		this.bg = Toolkit.getDefaultToolkit().getImage("src/images/bg01.jpg");
		this.player = new Player(this);
		this.thread = new DrawableThread(this);
		this.thread.start();
	}
	
	public void paintComponent(Graphics g) {
		super.paintComponent(g);
		timer ++;
		if(timer >= 10000) {
			timer = 0;
		}
		
		//»­±³¾°
		g.drawImage(bg, 0, top-bg.getHeight(this), bg.getWidth(this), bg.getHeight(this), null);
		g.drawImage(bg, 0, top, bg.getWidth(this), bg.getHeight(this), null);
		
		if(timer%10 == 0) {
			this.top += 1;
			if(top > bg.getHeight(this)) {
				top = 0;
			}
		}
		//»­·É»ú
		this.player.drawSelf(g);
		//»­×Óµ¯
		if(this.timer % 100 == 0) {
			Bullet b = new Bullet(this);
			b.x = this.player.x + this.player.width/2 - b.width/2;
			b.y = this.player.y;
			this.bullets.add(b);
		}
		for(int i = 0; i < this.bullets.size(); ++ i) {
			this.bullets.get(i).drawSelf(g);
		}
		
		if(this.timer % 100 == 0) {
			Enemy enemy = new Enemy(this);
			this.enemies.add(enemy);
		}
		for(int i = 0; i<this.enemies.size(); ++i) {
			this.enemies.get(i).drawSelf(g);
		}
		
	}	
	
}
